import json
from typing import Dict, List

from encounter_threat import Encounter, EncounterTile, EncounterEnemySlot
from enemies_io import id_to_enemy_name


ENEMY_SLOTS_BY_ENCOUNTER = {
	"A Trusty Ally": [2,2,0,0,0,2,1,0,0,0,0],
	"Abandoned and Forgotten": [0,0,0,0,3,0,0,0,0,0,0],
	"Abandoned Storeroom": [1,0,0,0,0,0,0,0,0,0,0],
	"Abandoned Tower": [3,2,0,0,0,0,0,0,0,0,0],
	"Aged Sentinel": [0,1,0,0,0,0,0,0,0,0,0],
	"Altar of Bones": [1,1,0,0,0,2,1,0,0,0,0],
	"Archive Entrance": [1,3,0,0,0,0,0,0,0,0,0],
	"Ash Gardens": [1,1,0,0,0,0,0,0,0,0,0],
	"Ashen Hollow": [1,2,0,0,0,0,0,0,0,0,0],
	"Asylum's North Hall": [2,2,2,2,0,0,0,0,0,0,0],
	"Base of Cardinal Tower": [2,3,2,2,0,0,0,0,0,0,0],
	"Black Bog": [2,2,0,0,0,0,0,0,0,0,0],
	"Black Dungeon": [3,1,0,0,0,0,0,0,0,0,0],
	"Blackroot Well": [1,2,0,0,0,0,0,0,0,0,0],
	"Blazing Furnace": [2,2,1,1,0,0,0,0,0,0,0],
	"Blazing Plaza": [1,2,0,0,0,0,0,0,0,0,0],
	"Boggy Hollow": [1,1,0,0,0,0,0,0,0,0,0],
	"Brass Sanctum": [1,2,0,0,0,0,0,0,0,0,0],
	"Bridge Too Far": [1,2,0,0,0,0,0,0,0,0,0],
	"Broken Passageway (TSC)": [1,1,0,0,0,0,0,0,0,0,0],
	"Broken Passageway": [1,2,0,0,0,0,0,0,0,0,0],
	"Bronze Spire": [1,1,0,0,0,0,0,0,0,0,0],
	"Brume Tower": [1,1,1,1,0,0,0,0,0,0,0],
	"Burned Gardens": [1,2,0,0,0,0,0,0,0,0,0],
	"Burning Hold": [1,2,0,0,0,0,0,0,0,0,0],
	"Burning Swamp": [1,2,0,0,0,0,0,0,0,0,0],
	"Castle Aflame": [2,2,0,0,0,0,0,0,0,0,0],
	"Castle Break In": [2,1,0,0,0,1,2,0,1,2,0],
	"Cells of the Dead": [1,2,3,1,0,0,0,0,0,0,0],
	"Cemetery of Ash": [3,3,0,0,0,0,0,0,0,0,0],
	"Central Irithyll": [1,2,0,0,0,0,0,0,0,0,0],
	"Central Plaza (TSC)": [2,2,0,0,1,0,0,0,0,0,0],
	"Central Plaza": [1,2,0,0,0,1,1,0,2,1,0],
	"Charred Keep": [2,2,0,0,0,0,0,0,0,0,0],
	"Cloak and Feathers": [1,0,0,0,0,0,0,0,0,0,0],
	"Cold Snap": [1,1,0,0,0,2,1,0,0,0,0],
	"Corpselight Fens": [2,2,0,0,0,0,0,0,0,0,0],
	"Corrupted Crypt": [2,2,0,0,0,0,0,0,0,0,0],
	"Corrupted Hovel": [2,2,0,0,0,0,0,0,0,0,0],
	"Corvian Host": [2,1,0,0,0,2,1,0,0,0,0],
	"Courtyard of Lothric": [3,2,3,1,0,0,0,0,0,0,0],
	"Cursed Cavern": [2,2,2,2,0,0,0,0,0,0,0],
	"Dark Alleyway": [1,2,0,0,0,0,0,0,0,0,0],
	"Dark Hollow": [1,0,0,0,0,0,0,0,0,0,0],
	"Dark Resurrection": [1,1,0,0,0,2,1,0,0,0,0],
	"Dark Woods": [1,2,0,0,0,0,0,0,0,0,0],
	"Darkened Chamber": [1,2,1,2,0,0,0,0,0,0,0],
	"Death's Precipice": [1,2,0,0,0,1,1,0,1,2,0],
	"Deathly Freeze": [3,1,0,0,0,1,2,0,0,0,0],
	"Deathly Magic": [2,1,0,0,0,0,0,0,0,0,0],
	"Deathly Tolls": [1,1,0,0,0,3,2,1,0,0,0],
	"Demon Ruins": [2,1,0,0,0,0,0,0,0,0,0],
	"Demon's Antechamber": [3,3,2,2,0,0,0,0,0,0,0],
	"Depths of the Cathedral": [3,1,0,0,0,2,2,1,3,2,0],
	"Desecrated Church": [3,3,0,0,0,0,0,0,0,0,0],
	"Desolate Cemetery": [2,2,0,0,0,0,0,0,0,0,0],
	"Desolate Hinterland": [1,2,0,0,0,0,0,0,0,0,0],
	"Dilapidated Bridge": [3,3,0,0,0,0,0,0,0,0,0],
	"Distant Tower": [2,1,0,0,0,1,1,0,1,0,0],
	"Draconic Decay": [0,1,0,0,0,1,1,0,1,2,0],
	"Dragon Shrine": [2,3,2,3,0,0,0,0,0,0,0],
	"Edge of the Abyss": [2,3,2,2,0,0,0,0,0,0,0],
	"Empty Crypt": [1,1,0,0,0,0,0,0,0,0,0],
	"Entryway of the Chasm": [2,2,2,3,0,0,0,0,0,0,0],
	"Eye of the Storm": [1,1,0,0,0,2,1,0,0,0,1],
	"Far From the Sun": [1,1,0,0,0,1,2,0,0,0,0],
	"Fearful Woods": [1,2,0,0,0,0,0,0,0,0,0],
	"Flaming Passageway": [1,1,0,0,0,0,0,0,0,0,0],
	"Flooded Fortress": [2,1,0,0,0,2,0,0,0,0,0],
	"Forest of Fallen Giants": [2,2,2,2,0,0,0,0,0,0,0],
	"Forgotten Gorge": [3,2,0,0,0,0,0,0,0,0,0],
	"Forsaken Depths": [2,2,0,0,0,0,0,0,0,0,0],
	"Fortress Gates": [1,1,2,1,0,0,0,0,0,0,0],
	"Frozen Revolutions": [2,2,0,0,0,2,0,0,1,1,0],
	"Frozen Sentries": [1,1,0,0,0,0,0,0,0,0,0],
	"Furnace Room": [1,2,0,0,0,0,0,0,0,0,0],
	"Gallery of the Hidden Warrior": [3,3,0,0,0,0,0,0,0,0,0],
	"Gate of Peril": [2,2,2,1,0,0,0,0,0,0,0],
	"Ghostly Keep": [2,1,0,0,0,0,0,0,0,0,0],
	"Giant's Coffin": [1,1,0,0,0,1,1,2,0,0,0],
	"Giant's Keep": [2,3,0,0,0,0,0,0,0,0,0],
	"Gleaming Silver": [1,1,0,0,0,1,2,1,0,0,0],
	"Gnashing Beaks": [1,1,0,0,3,1,0,0,0,0,0],
	"Gough's Perch": [2,2,2,2,0,0,0,0,0,0,0],
	"Grave Matters": [2,2,0,0,0,0,0,0,0,0,0],
	"Gravelord Nito Setup": [3,0,0,0,0,0,0,0,0,0,0],
	"Great Stone Bridge": [1,2,2,2,0,0,0,0,0,0,0],
	"Grim Reunion": [3,1,0,0,0,1,1,0,2,2,1],
	"Guarded Path": [1,3,1,3,0,0,0,0,0,0,0],
	"Hall of Wraiths": [1,2,1,2,0,0,0,0,0,0,0],
	"Halls of the Forsworn": [2,1,0,0,0,0,0,0,0,0,0],
	"Hanging Rafters": [2,1,0,0,0,2,2,0,0,0,0],
	"Haunted Ruins": [1,1,0,0,0,0,0,0,0,0,0],
	"Hidden Chamber": [2,3,0,0,0,0,0,0,0,0,0],
	"High Wall of Lothric": [2,2,0,0,0,0,0,0,0,0,0],
	"Hollow Cave": [2,1,0,0,0,0,0,0,0,0,0],
	"Hollowed Threshold": [2,3,0,0,0,0,0,0,0,0,0],
	"Honour Guard": [2,3,0,0,0,0,0,0,0,0,0],
	"Huntsman's Copse": [1,1,2,1,0,0,0,0,0,0,0],
	"Hydra Lake": [2,2,0,0,0,0,0,0,0,0,0],
	"Illusionary Doorway": [1,1,0,0,0,2,1,0,0,0,0],
	"In Deep Water": [2,2,0,0,2,0,0,0,0,0,0],
	"Inhospitable Ground": [1,1,0,0,0,0,1,0,0,0,0],
	"Iron Depths": [2,1,0,0,0,0,0,0,0,0,0],
	"Ironhearth Hall": [1,3,3,3,0,0,0,0,0,0,0],
	"Kingdom's Messengers": [1,1,0,0,0,2,1,0,0,0,0],
	"Lakeview Refuge": [1,2,0,0,0,1,1,2,1,2,0],
	"Last Rites": [1,1,0,0,0,0,0,0,0,0,0],
	"Last Shred of Light": [2,1,0,0,0,1,0,0,0,0,0],
	"Lava Path": [2,2,1,2,0,0,0,0,0,0,0],
	"Leafy Grotto": [1,2,0,0,0,0,0,0,0,0,0],
	"Lightless Passage": [2,2,0,0,0,0,0,0,0,0,0],
	"Lost Chapel": [2,1,0,0,0,3,1,0,1,0,0],
	"Lost Grotto": [1,2,0,0,0,0,0,0,0,0,0],
	"Lost Labyrinth": [1,1,0,0,0,0,0,0,0,0,0],
	"Lost Shrine": [3,3,0,0,0,0,0,0,0,0,0],
	"Lothric Castle": [2,1,0,0,0,0,0,0,0,0,0],
	"Manor Foregarden": [2,1,1,2,0,0,0,0,0,0,0],
	"Mausoleum Ruins": [1,3,0,0,0,0,0,0,0,0,0],
	"Maze of the Dead": [1,1,0,0,0,0,1,0,1,2,0],
	"Mega Boss Setup": [1,1,2,2,0,0,0,0,0,0,0],
	"Melting Gallery": [2,1,0,0,0,0,0,0,0,0,0],
	"Misty Burial Site": [2,2,0,0,0,0,0,0,0,0,0],
	"Misty Woods": [1,2,0,0,0,0,0,0,0,0,0],
	"Monstrous Maw": [0,1,0,0,0,0,0,0,0,0,0],
	"Murky Roots": [2,0,0,0,0,0,0,0,0,0,0],
	"New Londo Ruins": [3,1,1,2,0,0,0,0,0,0,0],
	"No Safe Haven": [2,0,0,0,0,1,0,0,0,0,0],
	"Outskirts of Blighttown": [2,2,2,2,0,0,0,0,0,0,0],
	"Overgrown Caves": [1,1,0,0,0,0,0,0,0,0,0],
	"Painted Passage": [2,1,0,0,0,0,0,0,0,0,0],
	"Parish Church": [2,1,0,0,0,1,2,0,3,1,1],
	"Parish Gates": [1,2,0,0,0,0,0,2,0,0,0],
	"Perilous Crossing": [2,3,2,3,0,0,0,0,0,0,0],
	"Perished Depths": [2,3,0,0,0,0,0,0,0,0,0],
	"Pit of the Dead": [1,2,0,0,0,0,0,0,0,0,0],
	"Pitch Black": [2,1,0,0,0,2,1,0,0,0,0],
	"Prison Tower": [2,1,0,0,0,0,0,0,0,0,0],
	"Profane Shrine": [3,3,0,0,0,0,0,0,0,0,0],
	"Promised Respite": [1,1,0,0,0,1,1,0,0,0,0],
	"Puppet Master": [2,0,0,0,0,0,0,0,0,0,0],
	"Pyre of Souls": [1,1,0,0,0,0,0,0,0,0,0],
	"Quiet Graveyard": [2,1,0,0,0,0,0,0,0,0,0],
	"Rain of Filth": [1,1,0,0,0,0,0,0,0,0,0],
	"Refuge of Silence": [3,3,0,0,0,0,0,0,0,0,0],
	"Research Library": [3,2,2,3,0,0,0,0,0,0,0],
	"Roll Out": [1,1,0,0,0,0,0,0,0,0,0],
	"Royal Woods Passage": [2,2,2,2,0,0,0,0,0,0,0],
	"Ruined Keep": [1,2,0,0,0,0,0,0,0,0,0],
	"Ruined Walkway": [1,1,2,1,0,0,0,0,0,0,0],
	"Scarlet Battlement": [3,3,0,0,0,0,0,0,0,0,0],
	"Scholars' Hall": [2,2,2,2,0,0,0,0,0,0,0],
	"Searing Hallway": [1,1,0,0,0,0,0,0,0,0,0],
	"Sentinel's Wrath": [0,1,0,0,0,0,0,0,0,0,0],
	"Sewers of Lordran": [3,1,3,2,0,0,0,0,0,0,0],
	"Shadow of the Abyss": [3,0,0,3,0,0,0,0,0,0,0],
	"Shattered Cell": [2,3,3,3,0,0,0,0,0,0,0],
	"Shattered Dungeon": [1,2,0,0,0,0,0,0,0,0,0],
	"Shattered Keep": [2,2,0,0,0,0,0,0,0,0,0],
	"Shrine of the Torch": [2,3,0,0,0,0,0,0,0,0,0],
	"Silent Pathway": [1,2,0,0,0,0,0,0,0,0,0],
	"Silent Tombs": [3,2,0,0,0,0,0,0,0,0,0],
	"Skeletal Spokes": [1,1,0,0,0,1,1,0,0,0,0],
	"Skeleton Overlord": [1,0,0,0,2,0,0,0,0,0,0],
	"Skittering Frenzy": [1,1,0,0,0,0,0,0,0,0,0],
	"Smoking Gallery": [2,3,0,0,0,0,0,0,0,0,0],
	"Smouldering Labyrinth": [2,1,0,0,0,0,0,0,0,0,0],
	"Snowblind": [1,1,0,0,0,1,1,0,0,0,0],
	"Sodden Mire": [2,3,0,0,0,0,0,0,0,0,0],
	"Spirit Tomb": [2,1,0,0,0,0,0,0,0,0,0],
	"Stone Hollow": [2,1,0,0,0,0,0,0,0,0,0],
	"Sunken Stairwell": [2,1,0,0,0,0,0,0,0,0,0],
	"Sunrise Pass": [2,1,0,0,0,0,0,0,0,0,0],
	"Sweltering Sanctum": [1,2,0,0,0,0,0,0,0,0,0],
	"Temple of the Deeps": [3,2,0,0,0,0,0,0,0,0,0],
	"Tempting Maw": [2,2,0,0,1,0,0,0,0,0,0],
	"The Abandoned Chest": [2,0,0,0,0,1,1,2,0,0,0],
	"The Beast From the Depths": [1,0,0,0,0,0,0,0,0,0,0],
	"The Bell Tower": [1,1,0,0,2,0,0,0,0,0,0],
	"The Castle Grounds": [2,2,2,2,0,0,0,0,0,0,0],
	"The Deeps": [2,1,0,0,0,0,0,0,0,0,0],
	"The Depths": [3,2,3,2,0,0,0,0,0,0,0],
	"The Desecrated Grave": [2,1,1,2,0,0,0,0,0,0,0],
	"The Dog's Domain": [2,1,2,3,0,0,0,0,0,0,0],
	"The First Bastion": [0,1,0,0,3,0,0,0,0,0,0],
	"The Forgotten": [2,1,0,0,0,0,0,0,0,0,0],
	"The Fountainhead": [3,2,0,0,0,0,0,0,0,0,0],
	"The Grand Hall": [3,0,0,0,0,2,2,1,1,2,0],
	"The Hellkite Bridge": [1,2,0,0,0,2,1,0,0,0,0],
	"The Iron Golem": [0,1,0,0,0,0,0,0,0,0,0],
	"The Last Bastion": [1,1,0,0,0,0,0,0,0,0,0],
	"The Locked Grave": [1,1,0,0,0,1,1,0,1,2,1],
	"The Mass Grave": [1,0,0,0,0,2,1,0,0,0,0],
	"The Petrified Fallen": [2,1,2,2,0,0,0,0,0,0,0],
	"The Shine of Gold": [2,1,0,0,0,0,0,0,0,0,0],
	"The Skeleton Ball": [1,1,0,0,0,1,1,0,1,3,0],
	"The Void Pit": [2,2,0,0,0,0,0,0,0,0,0],
	"Threshold Bridge": [1,2,0,0,0,0,0,0,0,0,0],
	"Trecherous Tower": [1,1,0,0,0,0,0,0,0,0,0],
	"Trophy Room": [2,2,0,0,0,2,2,0,0,0,0],
	"Twilight Falls": [2,2,0,0,0,2,1,0,2,3,0],
	"Undead Purgatory": [1,1,2,1,0,0,0,0,0,0,0],
	"Undead Sanctum": [2,1,0,0,0,2,1,0,0,0,0],
	"Unhallowed Caves": [1,2,0,0,0,0,0,0,0,0,0],
	"Unholy Tunnels": [1,2,0,0,0,0,0,0,0,0,0],
	"Unlighted Chamber": [2,1,0,0,0,0,0,0,0,0,0],
	"Unseen Scurrying": [1,1,0,0,0,0,0,0,0,0,0],
	"Untended Graves": [2,2,0,0,0,0,0,0,0,0,0],
	"Urns of the Fallen": [2,1,0,0,0,1,1,0,0,0,0],
	"Velka's Chosen": [1,1,0,0,0,1,2,0,0,0,0],
	"Wanderers Wood": [1,3,3,1,0,0,0,0,0,0,0],
	"Weathered Peak": [3,2,0,0,0,0,0,0,0,0,0],
	"Wicked Vault": [1,1,0,0,0,0,0,0,0,0,0],
	"Wild Glades": [2,1,0,0,0,0,0,0,0,0,0],
	"Withered Thicket": [1,2,0,0,0,0,0,0,0,0,0],
	"Wretched Gardens": [2,1,0,0,0,0,0,0,0,0,0]
}

ORIGINAL_ENEMIES_BY_ENCOUNTER = {
    "A Trusty Ally": [28,30,28,13,30,30,29],
    "Abandoned and Forgotten": [21,9,7],
    "Abandoned Storeroom": [13],
    "Abandoned Tower": [8,22,22,33,22],
    "Aged Sentinel": [23],
    "Altar of Bones": [30,12,30,28,13],
    "Archive Entrance": [34,25,25,23],
    "Ash Gardens": [25,6],
    "Ashen Hollow": [6,14,14],
    "Asylum's North Hall": [33,26,22,11,22,11,33,26],
    "Base of Cardinal Tower": [26,11,26,1,1,26,1,15,11],
    "Black Bog": [8,24,8,22],
    "Black Dungeon": [27,27,25,27],
    "Blackroot Well": [8,22,22],
    "Blazing Furnace": [2,3,11,11,15,36],
    "Blazing Plaza": [3,6,6],
    "Boggy Hollow": [32,17],
    "Brass Sanctum": [2,1,1],
    "Bridge Too Far": [30,28,30],
    "Broken Passageway (TSC)": [14,6],
    "Broken Passageway": [27,14,14],
    "Bronze Spire": [1,15],
    "Brume Tower": [10,4,40,15],
    "Burned Gardens": [16,27,27],
    "Burning Hold": [1,14,6],
    "Burning Swamp": [14,6,11],
    "Castle Aflame": [3,15,1,2],
    "Castle Break In": [14,14,23,14,6,6,27,25,25],
    "Cells of the Dead": [15,27,6,27,6,6,15],
    "Cemetery of Ash": [16,27,27,16,25,25],
    "Central Irithyll": [16,23,16],
    "Central Plaza (TSC)": [27,27,6,6,23],
    "Central Plaza": [21,21,21,9,9,31,31,7],
    "Charred Keep": [14,6,14,1],
    "Cloak and Feathers": [7],
    "Cold Snap": [31,31,21,9,21],
    "Corpselight Fens": [33,8,32,8],
    "Corrupted Crypt": [10,4,16,6],
    "Corrupted Hovel": [31,9,21,9],
    "Corvian Host": [21,21,7,21,21,7,7,7],
    "Courtyard of Lothric": [16,6,11,27,26,16,6,11,48],
    "Cursed Cavern": [16,25,16,25,23,6,23,6],
    "Dark Alleyway": [27,14,6],
    "Dark Hollow": [16],
    "Dark Resurrection": [30,19,30,30,19],
    "Dark Woods": [32,32,33],
    "Darkened Chamber": [33,17,8,33,18,8],
    "Death's Precipice": [28,30,30,12,13,12,13,29],
    "Deathly Freeze": [31,31,9,21,5,5,9],
    "Deathly Magic": [30,30,19],
    "Deathly Tolls": [27,27,25,14,14,25,6,34],
    "Demon Ruins": [25,27,16],
    "Demon's Antechamber": [16,14,14,25,6,6,23,6,16,14],
    "Depths of the Cathedral": [27,14,14,14,27,14,25,14,34,6,6,23,6,14],
    "Desecrated Church": [27,27,25,16,27,25],
    "Desolate Cemetery": [10,25,10,4],
    "Desolate Hinterland": [33,18,17],
    "Dilapidated Bridge": [16,14,6,16,14,6],
    "Distant Tower": [21,21,31,5,5,7],
    "Draconic Decay": [5,5,9,7,21,21],
    "Dragon Shrine": [23,6,14,14,14,27,27,27,6,6],
    "Edge of the Abyss": [23,14,16,6,6,25,25,27,27],
    "Empty Crypt": [23,23],
    "Entryway of the Chasm": [27,25,27,25,27,25,6,16,16],
    "Eye of the Storm": [21,21,21,21,9,20],
    "Far From the Sun": [30,13,30,19,30],
    "Fearful Woods": [22,24,17],
    "Flaming Passageway": [1,3],
    "Flooded Fortress": [6,14,34,6,6],
    "Forest of Fallen Giants": [27,16,6,14,6,23,27,16],
    "Forgotten Gorge": [14,14,25,14,25],
    "Forsaken Depths": [14,6,14,6],
    "Fortress Gates": [35,1,2,3,15],
    "Frozen Revolutions": [31,31,21,21,21,21,5,5],
    "Frozen Sentries": [21,21],
    "Furnace Room": [3,6,1],
    "Gallery of the Hidden Warrior": [26,26,25,26,25,25],
    "Gate of Peril": [4,32,10,14,10,14,8],
    "Ghostly Keep": [14,14,6],
    "Giant's Coffin": [13,12,13,12,12,13],
    "Giant's Keep": [26,27,25,26,27],
    "Gleaming Silver": [27,25,14,27,25,34],
    "Gnashing Beaks": [31,31,21,21,7,7],
    "Gough's Perch": [16,6,33,22,33,6,16,22],
    "Grave Matters": [30,28,30,28],
    "Gravelord Nito Setup": [30,30,13],
    "Great Stone Bridge": [23,27,6,27,6,23,6],
    "Grim Reunion": [14,14,6,25,23,27,25,14,27,6,34],
    "Guarded Path": [23,14,14,14,23,25,6,6],
    "Hall of Wraiths": [33,33,11,26,18,17],
    "Halls of the Forsworn": [16,11,14],
    "Hanging Rafters": [6,27,25,25,6,14,27],
    "Haunted Ruins": [33,8],
    "Hidden Chamber": [23,11,11,6,16],
    "High Wall of Lothric": [16,14,14,6],
    "Hollow Cave": [14,14,14],
    "Hollowed Threshold": [1,2,1,1,2],
    "Honour Guard": [30,28,30,30,28],
    "Huntsman's Copse": [4,4,6,10,14],
    "Hydra Lake": [18,8,17,33],
    "Illusionary Doorway": [6,27,25,14,25],
    "In Deep Water": [12,30,30,30,28,28],
    "Inhospitable Ground": [31,9,20],
    "Iron Depths": [1,1,2],
    "Ironhearth Hall": [27,23,6,6,16,14,14,16,25,25],
    "Kingdom's Messengers": [14,27,6,6,27],
    "Lakeview Refuge": [19,30,30,28,28,19,12,13,29],
    "Last Rites": [30,30],
    "Last Shred of Light": [29,30,28,12],
    "Lava Path": [27,6,27,6,6,23,23],
    "Leafy Grotto": [24,22,8],
    "Lightless Passage": [16,14,14,14],
    "Lost Chapel": [30,30,19,28,28,19,30,29],
    "Lost Grotto": [26,25,26],
    "Lost Labyrinth": [16,16],
    "Lost Shrine": [27,27,25,27,25,25],
    "Lothric Castle": [14,11,11],
    "Manor Foregarden": [33,15,8,8,33,15],
    "Mausoleum Ruins": [16,10,6,6],
    "Maze of the Dead": [30,19,29,28,30,30],
    "Mega Boss Setup": [10,10,4,10,4,10],
    "Melting Gallery": [2,2,2],
    "Misty Burial Site": [6,27,14,10],
    "Misty Woods": [24,24,22],
    "Monstrous Maw": [31],
    "Murky Roots": [18,17],
    "New Londo Ruins": [2,6,6,15,15,3,1],
    "No Safe Haven": [31,31,9],
    "Outskirts of Blighttown": [23,25,23,25,16,6,16,6],
    "Overgrown Caves": [17,8],
    "Painted Passage": [31,31,21],
    "Parish Church": [14,14,25,27,25,14,6,6,6,27,34],
    "Parish Gates": [6,6,6,14,14],
    "Perilous Crossing": [16,6,27,27,25,16,6,27,25,25],
    "Perished Depths": [23,14,14,6,6],
    "Pit of the Dead": [23,23,25],
    "Pitch Black": [28,19,30,30,30,19],
    "Prison Tower": [27,25,27],
    "Profane Shrine": [27,27,27,16,14,14],
    "Promised Respite": [21,31,31,9],
    "Puppet Master": [13,19],
    "Pyre of Souls": [15,6],
    "Quiet Graveyard": [10,25,14],
    "Rain of Filth": [28,28],
    "Refuge of Silence": [16,26,11,16,26,11],
    "Research Library": [27,27,11,26,6,26,6,27,25,25],
    "Roll Out": [5,5],
    "Royal Woods Passage": [32,22,2,1,32,22,1,22],
    "Ruined Keep": [6,14,6],
    "Ruined Walkway": [33,33,2,1,2],
    "Scarlet Battlement": [16,11,14,16,26,11],
    "Scholars' Hall": [16,6,23,14,23,14,16,6],
    "Searing Hallway": [15,3],
    "Sentinel's Wrath": [23],
    "Sewers of Lordran": [16,6,6,39,16,11,11,26,25],
    "Shadow of the Abyss": [33,16,17,16,33,32],
    "Shattered Cell": [16,14,27,25,6,27,25,6,16,14,14],
    "Shattered Dungeon": [14,6,6],
    "Shattered Keep": [25,6,6,6],
    "Shrine of the Torch": [3,3,2,1,1],
    "Silent Pathway": [10,14,6],
    "Silent Tombs": [16,27,27,16,25],
    "Skeletal Spokes": [9,9,5,5],
    "Skeleton Overlord": [13,30,30],
    "Skittering Frenzy": [31,31],
    "Smoking Gallery": [3,3,3,1,2],
    "Smouldering Labyrinth": [2,1,3],
    "Snowblind": [21,5,21,7],
    "Sodden Mire": [8,22,8,22,33],
    "Spirit Tomb": [27,26,25],
    "Stone Hollow": [22,24,32],
    "Sunken Stairwell": [25,27,26],
    "Sunrise Pass": [25,25,16],
    "Sweltering Sanctum": [15,15,1],
    "Temple of the Deeps": [14,14,6,14,6],
    "Tempting Maw": [25,14,14,6,34],
    "The Abandoned Chest": [30,30,28,19,13,12],
    "The Beast From the Depths": [29],
    "The Bell Tower": [6,6,14,14],
    "The Castle Grounds": [2,3,2,3,2,3,1,1],
    "The Deeps": [27,14,6],
    "The Depths": [27,6,6,16,25,27,27,6,16,25],
    "The Desecrated Grave": [16,16,6,6,23,23],
    "The Dog's Domain": [16,27,25,16,27,23,6,6],
    "The First Bastion": [31,31,21,9],
    "The Forgotten": [14,14,25],
    "The Fountainhead": [6,14,14,6,14],
    "The Grand Hall": [6,6,27,27,23,25,27,34,23,25,25],
    "The Hellkite Bridge": [27,6,6,14,14,27],
    "The Iron Golem": [23],
    "The Last Bastion": [20,7],
    "The Locked Grave": [12,30,13,19,12,28,28,29],
    "The Mass Grave": [13,30,30,13],
    "The Petrified Fallen": [32,22,18,17,8,32,22],
    "The Shine of Gold": [14,14,34],
    "The Skeleton Ball": [19,12,28,13,12,19,30,30],
    "The Void Pit": [11,11,16,11],
    "Threshold Bridge": [1,14,6],
    "Trecherous Tower": [21,21,21,9,7],
    "Trophy Room": [14,34,14,14,27,6,27,6],
    "Twilight Falls": [27,27,25,25,6,14,34,23,14,6,6,27],
    "Undead Purgatory": [10,6,4,23,27],
    "Undead Sanctum": [14,6,6,14,14,27],
    "Unhallowed Caves": [26,26,11],
    "Unholy Tunnels": [26,14,11],
    "Unlighted Chamber": [14,6,27],
    "Unseen Scurrying": [31,31],
    "Untended Graves": [25,25,23,27],
    "Urns of the Fallen": [28,30,30,28,30],
    "Velka's Chosen": [9,9,7,31,31],
    "Wanderers Wood": [23,6,6,14,6,14,14,23],
    "Weathered Peak": [27,27,6,25,14],
    "Wicked Vault": [26,11],
    "Wild Glades": [22,24,22],
    "Withered Thicket": [18,17,22],
    "Wretched Gardens": [23,25,16]
}

ENEMY_ENCOUNTER_BY_ENEMY_NAME = {
	"Alonne Bow Knight": "Iron Keep",
	"Alonne Knight Captain": "Iron Keep",
	"Alonne Sword Knight": "Iron Keep",
	"Black Hollow Mage": "Executioner Chariot",
	"Bonewheel Skeleton": "Painted World of Ariamis",
	"Crossbow Hollow": "Dark Souls The Board Game",
	"Crow Demon": "Painted World of Ariamis",
	"Demonic Foliage": "Darkroot",
	"Engorged Zombie": "Painted World of Ariamis",
	"Falchion Skeleton": "Executioner Chariot",
	"Firebomb Hollow": "Explorers",
	"Giant Skeleton Archer": "Tomb of Giants",
	"Giant Skeleton Soldier": "Tomb of Giants",
	"Hollow Soldier": "Dark Souls The Board Game",
	"Ironclad Soldier": "Iron Keep",
	"Large Hollow Soldier": "Dark Souls The Board Game",
	"Mimic": "The Sunless City",
	"Mushroom Child": "Darkroot",
	"Mushroom Parent": "Darkroot",
	"Necromancer": "Tomb of Giants",
	"Phalanx": "Painted World of Ariamis",
	"Phalanx Hollow": "Painted World of Ariamis",
	"Plow Scarecrow": "Darkroot",
	"Sentinel": "Dark Souls The Board Game",
	"Shears Scarecrow": "Darkroot",
	"Silver Knight Greatbowman": "Dark Souls The Board Game",
	"Silver Knight Spearman": "Explorers",
	"Silver Knight Swordsman": "Dark Souls The Board Game",
	"Skeleton Archer": "Tomb of Giants",
	"Skeleton Beast": "Tomb of Giants",
	"Skeleton Soldier": "Tomb of Giants",
	"Snow Rat": "Painted World of Ariamis",
	"Stone Guardian": "Darkroot",
	"Stone Knight": "Darkroot",
}


def _build_slots_from_ids(ids: List[int]) -> List[EncounterEnemySlot]:
    """
    Convert a flat list of enemy IDs (like [31,31,9]) into
    EncounterEnemySlot(name, count) with counts aggregated.
    """
    counter: Dict[int, int] = {}
    for eid in ids:
        counter[eid] = counter.get(eid, 0) + 1

    slots: List[EncounterEnemySlot] = []
    for eid, count in counter.items():
        name = id_to_enemy_name.get(eid)
        if name is None:
            # Unknown ID â€“ you can raise or just skip
            # raise ValueError(f"Unknown enemy id {eid}")
            continue
        slots.append(EncounterEnemySlot(name=name, count=count))
    return slots


def load_encounters_from_json(path: str) -> Dict[str, Encounter]:
    """
    Load encounters.json (the big one you showed) into Encounter objects.

    JSON shape (per encounter):
      {
        "name": "No Safe Haven",
        "expansion": "Painted World of Ariamis",
        "level": 1,
        "tiles": {
          "1": {"enemies": [31,31], "spawns": []},
          "2": {"enemies": [9], "spawns": []},
          "3": {"enemies": [], "spawns": []}
        },
        "difficultyOrder": {
          "1": [0,1,2],
          ...
        }
      }
    """
    with open(path, "r", encoding="utf-8") as f:
        data = json.load(f)

    encounters: Dict[str, Encounter] = {}

    for enc_name, enc_obj in data.items():
        tiles_json = enc_obj["tiles"]

        tiles: List[EncounterTile] = []
        # Tiles are keyed as "1", "2", "3"
        for tile_key in sorted(tiles_json.keys(), key=int):
            t = tiles_json[tile_key]
            enemy_ids = t.get("enemies", [])
            spawn_ids = t.get("spawns", [])

            # As per your note: spawns get treated just like regular enemies
            all_ids = list(enemy_ids) + list(spawn_ids)

            slots = _build_slots_from_ids(all_ids)
            tile = EncounterTile(
                name=f"{enc_name} - Tile {tile_key}",
                enemies=slots,
            )
            tiles.append(tile)

        encounters[enc_name] = Encounter(
            name=enc_name,
            level=enc_obj["level"],
            tiles=tiles,
        )

    return encounters
